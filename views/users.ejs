<%- include('./modules/_header', {page: "User Management"}); %>
<%- include('./modules/_navs', {page: "Users"}); %>
<div class="d-flex justify-content-between flex-wrap flex-md-nowrap
    align-items-center border-bottom mt-5 mt-md-3 py-4">
    <h1 class="h3 content-header">
        <i class="ic-user"></i>
        User Access Controls
    </h1>
    <div class="content-action btn-toolbar mb-2 mb-md-0">
        <button type="button" class="btn btn-sm btn-primary" data-toggle="modal"
            data-target="#addUser">
            <i class="ic-add-user"></i>&nbsp;
            Add New User
        </button>
    </div>
</div>

<h5 class="text-center t-primary my-4">
    Only Admin Can Access This Page
</h5>

<%- include('./modules/_alert') %>

<!-- Add/Edit User -->
<div class="modal fade" id="addUser" tabindex="-1" role="dialog"
    data-backdrop="static">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title t-primary userForm-title">
                    Add New User
                </h5>
                <button type="button" class="close" data-dismiss="modal"
                    aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form class="userForm" action="/users" method="post">
                    <div class="form-group">
                        <label for="name">
                            Name</label>
                        <input type="text" class="form-control userForm-name" name="name"
                            placeholder="John Doe" required minlength="5"/>
                    </div>
                    <div class="form-group">
                        <label for="email">Email
                            Address</label>
                        <input type="email" class="form-control userForm-email" name="email"
                            placeholder="johndoe@gmail.com" required />
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" class="form-control"
                            name="password" placeholder="***********"
                            required minlength="6"/>
                    </div>

                    <div class="form-group">
                        <label for="role">User Role</label>
                        <select class="form-control userForm-role" name="role" required>
                            <option value="">Select Current User Role</option>
                            <option value="admin">Admin
                            </option>
                            <option value="service">Services
                            </option>
                            <option value="sales">Sales
                            </option>
                        </select>
                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary"
                            data-dismiss="modal">
                            <i class="ic-cross"></i> Close
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="ic-check"></i> Save
                            Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Delete Modals -->
<div class="modal fade" id="deleteModal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title text-danger">Delete
                    User?</h5>
                <button type="button" class="close" data-dismiss="modal"
                    aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                Do you really want to delete this?
                <p class="text-muted">This action is
                    irreversible.</p>
                <form method="Post" class="delete-form">
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary"
                            data-dismiss="modal">
                            <i class="ic-cross"></i> Close
                        </button>
                        <button type="submit" class="btn btn-danger">
                            <i class="ic-trash"></i> Confirm
                            Delete
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<div class="content-box">
    <div class="table-responsive">
        <table class="table table-striped table-sm">
            <thead class="table__header">
                <tr>
                    <th>Name</th>
                    <th>Email Address</th>
                    <th>Roles</th>
                    <th class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody class="table__body">
                <% if(locals.users) {
                    users.forEach((user)=>{ %>
                <tr>
                    <td><%= user.name %></td>
                    <td><%= user.email %></td>
                    <td>
                        <span class="badge badge-warning text-uppercase">
                            <%= user.role %>
                        </span>
                    </td>
                    <td class="table__actions text-center" data-item-id="<%= user.id %>">
                        <a href="#" class="table__actions-btn userEditButtons" data-toggle="modal" data-target="#addUser">
                            <i class="ic-pencil pr-2"></i>Edit</a>
                        <a href="#" class="table__actions-btn" data-toggle="modal" data-target="#deleteModal">
                            <i class="ic-trash pr-2"></i>Delete</a>
                    </td>
                </tr>
                <% })} %>
            </tbody>
        </table>
    </div>
</div>
<%- include('./modules/_footer'); %>